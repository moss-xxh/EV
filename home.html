<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>移动充电 - 系统页</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f5f5f5 0%, #e0e0e0 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            width: 100vw;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }

        /* iPhone 外框 */
        .iphone-frame {
            width: 393px;
            height: 852px;
            background: #1a1a1a;
            border-radius: 55px;
            padding: 12px;
            box-shadow:
                0 0 0 2px #2a2a2a,
                0 0 0 8px #1a1a1a,
                0 30px 80px rgba(0, 0, 0, 0.5);
            position: relative;
            transform: scale(1.1);
            transform-origin: center;
        }

        /* 响应式缩放 */
        @media (max-height: 1000px) {
            .iphone-frame {
                transform: scale(0.95);
            }
        }

        @media (max-height: 900px) {
            .iphone-frame {
                transform: scale(0.85);
            }
        }

        @media (max-height: 800px) {
            .iphone-frame {
                transform: scale(0.75);
            }
        }

        /* 灵动岛区域 */
        .dynamic-island {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 126px;
            height: 37px;
            background: #000;
            border-radius: 22px;
            z-index: 10;
            box-shadow:
                inset 0 1px 2px rgba(255, 255, 255, 0.1),
                0 0 0 0.5px rgba(0, 0, 0, 0.8);
        }

        /* 灵动岛内的摄像头和传感器 */
        .island-camera {
            position: absolute;
            top: 50%;
            left: 30px;
            transform: translateY(-50%);
            width: 10px;
            height: 10px;
            background: #0a0a0a;
            border-radius: 50%;
            border: 0.5px solid #222;
        }

        .island-sensor {
            position: absolute;
            top: 50%;
            right: 30px;
            transform: translateY(-50%);
            width: 8px;
            height: 8px;
            background: #0a0a0a;
            border-radius: 50%;
        }

        /* 屏幕内容区域 */
        .screen {
            width: 100%;
            height: 100%;
            background: #F5F5F5;
            border-radius: 45px;
            overflow: hidden;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        /* 状态栏 */
        .status-bar {
            height: 54px;
            background: transparent;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 0 20px;
            padding-top: 16px;
            font-size: 15px;
            font-weight: 600;
            color: #000;
            position: relative;
        }

        .time {
            font-weight: 600;
            position: absolute;
            left: 35px;
            top: 18px;
        }

        .status-icons {
            display: flex;
            gap: 6px;
            align-items: center;
            position: absolute;
            right: 35px;
            top: 18px;
        }

        /* 信号图标 */
        .signal {
            display: flex;
            gap: 1px;
            align-items: flex-end;
            height: 12px;
        }

        .signal-bar {
            width: 3px;
            background: #000;
            border-radius: 1px;
        }

        .signal-bar:nth-child(1) { height: 4px; }
        .signal-bar:nth-child(2) { height: 6px; }
        .signal-bar:nth-child(3) { height: 8px; }
        .signal-bar:nth-child(4) { height: 10px; }

        /* WiFi 图标 */
        .wifi {
            width: 15px;
            height: 11px;
            position: relative;
        }

        .wifi::before {
            content: '◗';
            font-size: 15px;
            color: #000;
            transform: rotate(45deg);
            display: block;
        }

        /* 电池图标 */
        .battery {
            width: 24px;
            height: 11px;
            border: 1.5px solid #000;
            border-radius: 3px;
            position: relative;
            margin-left: 5px;
            display: flex;
            align-items: center;
            padding: 2px;
        }

        .battery::before {
            content: '';
            position: absolute;
            right: -3px;
            top: 50%;
            transform: translateY(-50%);
            width: 1.5px;
            height: 4px;
            background: #000;
            border-radius: 0 1px 1px 0;
        }

        .battery::after {
            content: '';
            width: 100%;
            height: 100%;
            background: #000;
            border-radius: 1px;
        }

        /* 主内容区域 */
        .main-content {
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
            padding: 20px;
            padding-bottom: 110px; /* 为悬浮菜单栏预留空间 */
            -webkit-overflow-scrolling: touch;
        }

        /* 隐藏滚动条但保持滚动功能 */
        .main-content::-webkit-scrollbar {
            display: none;
        }

        .main-content {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* 页面内容 */
        .page-content {
            display: none;
        }

        .page-content.active {
            display: block;
        }

        /* 设备页面 */
        #devicePage {
            position: relative;
            height: 100%;
            width: 100%;
        }

        .initial-view {
            position: relative;
            height: 100%;
            width: 100%;
        }

        .device-header {
            font-size: 28px;
            font-weight: 700;
            color: #000;
            margin-bottom: 20px;
        }

        .connect-btn {
            width: 200px;
            height: 200px;
            background: linear-gradient(135deg, #0052CC 0%, #003B99 100%);
            color: #fff;
            border: none;
            border-radius: 50%;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 12px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            box-shadow:
                0 12px 40px rgba(0, 82, 204, 0.4),
                0 6px 20px rgba(0, 82, 204, 0.3),
                0 2px 8px rgba(0, 0, 0, 0.1);
            /* 添加吸引眼球的动画 */
            animation: connectBtnFloat 3s ease-in-out infinite;
            z-index: 1;
        }

        /* 连接按钮浮动动画 */
        @keyframes connectBtnFloat {
            0%, 100% {
                transform: translate(-50%, -50%) scale(1);
            }
            50% {
                transform: translate(-50%, -52%) scale(1.05);
            }
        }

        /* 连接按钮脉冲光晕效果 */
        .connect-btn::before {
            content: '';
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            background: radial-gradient(circle, rgba(0, 82, 204, 0.4) 0%, transparent 70%);
            border-radius: 50%;
            animation: connectBtnPulse 3s ease-in-out infinite;
            z-index: -1;
        }

        @keyframes connectBtnPulse {
            0%, 100% {
                transform: scale(1);
                opacity: 0.6;
            }
            50% {
                transform: scale(1.2);
                opacity: 0.3;
            }
        }

        .connect-btn:active {
            transform: translate(-50%, -50%) scale(0.95);
            background: linear-gradient(135deg, #003B99 0%, #002B75 100%);
            box-shadow:
                0 8px 32px rgba(0, 82, 204, 0.35),
                0 4px 16px rgba(0, 82, 204, 0.25),
                0 2px 6px rgba(0, 0, 0, 0.1);
            animation: none; /* 点击时停止浮动动画 */
        }

        .connect-btn svg {
            width: 48px;
            height: 48px;
            stroke: #fff;
            fill: none;
            stroke-width: 2.5;
            stroke-linecap: round;
            stroke-linejoin: round;
            /* 给图标添加轻微的旋转动画 */
            animation: connectIconRotate 4s ease-in-out infinite;
        }

        @keyframes connectIconRotate {
            0%, 100% {
                transform: rotate(0deg);
            }
            25% {
                transform: rotate(-5deg);
            }
            75% {
                transform: rotate(5deg);
            }
        }

        /* 扩散圆环容器 */
        .ripple-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 200px;
            height: 200px;
            pointer-events: none;
            z-index: 0;
        }

        /* 扩散圆环 */
        .ripple {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 1.5px solid rgba(0, 82, 204, 0.25);
            border-radius: 50%;
            animation: rippleEffect 3s ease-out infinite;
            opacity: 0;
        }

        .ripple:nth-child(1) {
            animation-delay: 0s;
        }

        .ripple:nth-child(2) {
            animation-delay: 1s;
        }

        .ripple:nth-child(3) {
            animation-delay: 2s;
        }

        @keyframes rippleEffect {
            0% {
                transform: scale(1);
                opacity: 0.4;
            }
            100% {
                transform: scale(1.8);
                opacity: 0;
            }
        }

        /* 扫描状态 */
        .scanning-view {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            padding: 0 16px 120px 16px;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .scanning-view.active {
            display: block;
        }

        /* 隐藏扫描视图滚动条 */
        .scanning-view::-webkit-scrollbar {
            display: none;
        }

        .scanning-view {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .scanning-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
            padding: 8px 0;
            margin-left: -8px;
            margin-right: -8px;
        }

        .scanning-title {
            font-size: 17px;
            font-weight: 600;
            color: #000;
            flex: 1;
            text-align: center;
        }


        .back-btn {
            width: 36px;
            height: 36px;
            background: transparent;
            border: none;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            padding: 0;
            margin: 0;
        }

        .back-btn:active {
            transform: scale(0.9);
            opacity: 0.6;
        }

        .back-btn svg {
            width: 24px;
            height: 24px;
            stroke: #0052CC;
            fill: none;
            stroke-width: 2.5;
            stroke-linecap: round;
            stroke-linejoin: round;
        }

        #refreshBtn.refreshing svg {
            animation: rotate 1s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }


        /* 雷达扫描区域 */
        .radar-container {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 32px 0 16px;
            margin-bottom: 12px;
        }

        .radar-wrapper {
            position: relative;
            width: 200px;
            height: 200px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .radar-circle {
            position: absolute;
            border-radius: 50%;
            border: 2px solid rgba(0, 82, 204, 0.2);
        }

        .radar-circle:nth-child(1) {
            width: 200px;
            height: 200px;
            background: rgba(0, 82, 204, 0.03);
            animation: radarPulse 3s ease-out infinite;
        }

        .radar-circle:nth-child(2) {
            width: 160px;
            height: 160px;
            background: rgba(0, 82, 204, 0.05);
            animation: radarPulse 3s ease-out infinite 0.5s;
        }

        .radar-circle:nth-child(3) {
            width: 120px;
            height: 120px;
            background: rgba(0, 82, 204, 0.08);
            animation: radarPulse 3s ease-out infinite 1s;
        }

        .radar-circle:nth-child(4) {
            width: 80px;
            height: 80px;
            background: rgba(0, 82, 204, 0.12);
            animation: radarPulse 3s ease-out infinite 1.5s;
        }

        @keyframes radarPulse {
            0%, 100% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.1);
                opacity: 0.6;
            }
        }

        .bluetooth-icon-wrapper {
            position: relative;
            z-index: 10;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #0052CC 0%, #003B99 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(0, 82, 204, 0.3);
        }

        .bluetooth-icon-wrapper svg {
            width: 24px;
            height: 24px;
            fill: #fff;
        }

        .radar-scanning-text {
            text-align: center;
            margin-top: -10px;
            margin-bottom: 24px;
            font-size: 15px;
            color: #8E8E93;
        }

        .device-list {
            display: flex;
            flex-direction: column;
            gap: 0;
        }

        .device-list.hidden {
            display: none;
        }

        /* 设备分组标题 - 隐藏 */
        .device-section-title {
            display: none;
        }

        /* 卡片式设备列表 */
        .device-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .device-card {
            background: #fff;
            border-radius: 12px;
            padding: 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
        }

        .device-card:active {
            transform: scale(0.98);
            opacity: 0.8;
        }

        /* 隐藏设备图标 */
        .device-icon {
            display: none;
        }

        .device-info {
            flex: 1;
            min-width: 0;
        }

        .device-name {
            font-size: 17px;
            font-weight: 600;
            color: #000;
            margin-bottom: 0;
        }

        .device-status {
            display: none;
        }

        /* 右侧连接按钮 */
        .device-arrow {
            display: none;
        }

        .connect-device-btn {
            background: #0052CC;
            color: #fff;
            border: none;
            border-radius: 20px;
            padding: 8px 20px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            white-space: nowrap;
        }

        .connect-device-btn:active {
            transform: scale(0.95);
            background: #003B99;
        }

        /* 我的页面 - iOS 白色卡片主题 */
        .menu-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .menu-item {
            background: #fff;
            border-radius: 12px;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            cursor: pointer;
            transition: all 0.2s;
            overflow: hidden;
            min-height: 60px;
        }

        .menu-item:active {
            background: #F5F5F5;
        }

        .menu-item-left {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px;
            flex: 1;
        }

        .menu-icon {
            width: 36px;
            height: 36px;
            background: #F5F5F5;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .menu-icon svg {
            width: 20px;
            height: 20px;
            stroke: #000;
            fill: none;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
        }

        .menu-label {
            font-size: 17px;
            font-weight: 400;
            color: #000;
        }

        .menu-arrow {
            font-size: 20px;
            color: #C7C7CC;
            padding-right: 16px;
            font-weight: 300;
        }

        .menu-value {
            font-size: 16px;
            color: #8E8E93;
            display: flex;
            align-items: center;
            gap: 6px;
            padding-right: 16px;
        }

        .menu-value::after {
            content: '›';
            font-size: 20px;
            color: #C7C7CC;
            font-weight: 300;
        }

        /* 遮罩层 */
        .overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.4);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 200;
            border-radius: 45px;
        }

        .overlay.active {
            opacity: 1;
            visibility: visible;
        }

        /* 底部抽屉 */
        .drawer {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: #fff;
            border-radius: 20px 20px 45px 45px;
            padding: 20px 20px 30px;
            transform: translateY(100%);
            transition: transform 0.3s ease;
            z-index: 201;
            max-height: 50%;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .drawer.active {
            transform: translateY(0);
        }

        /* 隐藏抽屉滚动条 */
        .drawer::-webkit-scrollbar {
            display: none;
        }

        .drawer {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .drawer-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #E5E5EA;
        }

        .drawer-title {
            font-size: 18px;
            font-weight: 600;
            color: #000;
        }

        .drawer-close {
            width: 28px;
            height: 28px;
            background: #F2F2F7;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 18px;
            color: #8E8E93;
            transition: all 0.2s ease;
        }

        .drawer-close:active {
            transform: scale(0.9);
            background: #E5E5EA;
        }

        .drawer-options {
            display: flex;
            flex-direction: column;
            gap: 0;
        }

        .drawer-option {
            padding: 16px 20px;
            font-size: 16px;
            color: #000;
            border-bottom: 0.5px solid #E5E5EA;
            cursor: pointer;
            transition: background 0.2s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .drawer-option:last-child {
            border-bottom: none;
        }

        .drawer-option:active {
            background: #F2F2F7;
        }

        .drawer-option.selected {
            color: #000;
            font-weight: 600;
            background: #F5F5F5;
        }

        .drawer-option.selected::after {
            content: '✓';
            font-size: 18px;
            color: #000;
        }

        /* 隐私协议抽屉 */
        .privacy-drawer {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: #fff;
            border-radius: 20px 20px 45px 45px;
            padding: 0;
            transform: translateY(100%);
            transition: transform 0.3s ease;
            z-index: 201;
            max-height: 75%;
            display: flex;
            flex-direction: column;
        }

        .privacy-drawer.active {
            transform: translateY(0);
        }

        .privacy-drawer .drawer-header {
            padding: 20px;
            border-bottom: 1px solid #E5E5EA;
            flex-shrink: 0;
        }

        .privacy-drawer .drawer-close {
            display: none;
        }

        .privacy-content {
            flex: 1;
            overflow-y: scroll;
            overflow-x: hidden;
            padding: 20px;
            line-height: 1.6;
            -webkit-overflow-scrolling: touch;
        }

        /* 隐藏隐私协议滚动条 */
        .privacy-content::-webkit-scrollbar {
            display: none;
        }

        .privacy-content {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .privacy-content h2 {
            font-size: 18px;
            font-weight: 600;
            color: #000;
            margin-bottom: 12px;
            margin-top: 20px;
        }

        .privacy-content h2:first-child {
            margin-top: 0;
        }

        .privacy-content p {
            font-size: 14px;
            color: #333;
            margin-bottom: 12px;
        }

        .privacy-content ul {
            margin: 10px 0;
            padding-left: 20px;
        }

        .privacy-content li {
            font-size: 14px;
            color: #333;
            margin-bottom: 8px;
        }

        /* 同意按钮 */
        .privacy-footer {
            padding: 15px 20px 25px;
            border-top: 1px solid #E5E5EA;
            flex-shrink: 0;
        }

        .agree-btn {
            width: 100%;
            height: 48px;
            background: #0052CC;
            color: #fff;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .agree-btn:active {
            transform: scale(0.98);
            background: #003B99;
        }

        /* 底部菜单栏 - 悬浮白色风格 */
        .bottom-nav {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 22px;
            display: flex;
            justify-content: space-around;
            padding: 10px 16px;
            position: absolute;
            bottom: 25px;
            left: 16px;
            right: 16px;
            height: 70px;
            z-index: 100;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 3px;
            cursor: pointer;
            transition: all 0.25s ease;
            flex: 1;
        }

        .nav-item:active {
            transform: scale(0.88);
        }

        .nav-icon {
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.25s ease;
        }

        .nav-icon svg {
            width: 100%;
            height: 100%;
            stroke: #8E8E93;
            fill: none;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
            transition: stroke 0.25s ease;
        }

        .nav-item.active .nav-icon svg {
            stroke: #0052CC;
            stroke-width: 2;
        }

        .nav-label {
            font-size: 11px;
            color: #8E8E93;
            font-weight: 500;
            transition: all 0.25s ease;
        }

        .nav-item.active .nav-label {
            color: #0052CC;
            font-weight: 600;
        }

        /* 底部指示条 */
        .home-indicator {
            position: absolute;
            bottom: 8px;
            left: 50%;
            transform: translateX(-50%);
            width: 140px;
            height: 5px;
            background: #000;
            border-radius: 3px;
            opacity: 0.3;
        }

        /* 系统弹窗 - iOS 风格 */
        .system-alert {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            width: 270px;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(40px);
            -webkit-backdrop-filter: blur(40px);
            border-radius: 14px;
            overflow: hidden;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 202;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        .system-alert.active {
            opacity: 1;
            visibility: visible;
            transform: translate(-50%, -50%) scale(1);
        }

        .alert-content {
            padding: 19px 16px 20px;
            text-align: center;
        }

        .alert-title {
            font-size: 17px;
            font-weight: 600;
            color: #000;
            margin-bottom: 2px;
            line-height: 1.29412;
            letter-spacing: -0.41px;
        }

        .alert-message {
            font-size: 13px;
            color: #000;
            line-height: 1.23077;
            opacity: 0.6;
            letter-spacing: -0.08px;
        }

        .alert-buttons {
            margin-top: 20px;
            border-top: 0.5px solid rgba(60, 60, 67, 0.18);
            display: flex;
            flex-direction: row;
        }

        .alert-button {
            flex: 1;
            height: 44px;
            background: transparent;
            border: none;
            font-size: 17px;
            color: #0052CC;
            cursor: pointer;
            transition: background 0.15s ease;
            font-weight: 400;
            letter-spacing: -0.4px;
        }

        .alert-button:active {
            background: rgba(0, 0, 0, 0.04);
        }

        .alert-button.primary {
            font-weight: 600;
            border-left: 0.5px solid rgba(60, 60, 67, 0.18);
        }

        .alert-button.cancel {
            color: #0052CC;
            font-weight: 400;
        }

        /* 定位权限弹窗 - iOS大卡片样式 */
        .location-permission-alert {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            width: 320px;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(40px);
            -webkit-backdrop-filter: blur(40px);
            border-radius: 20px;
            overflow: hidden;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 202;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        .location-permission-alert.active {
            opacity: 1;
            visibility: visible;
            transform: translate(-50%, -50%) scale(1);
        }

        .location-alert-content {
            padding: 24px 20px 20px;
            text-align: center;
        }

        .location-alert-title {
            font-size: 17px;
            font-weight: 600;
            color: #000;
            margin-bottom: 8px;
            line-height: 1.3;
            letter-spacing: -0.41px;
        }

        .location-alert-message {
            font-size: 13px;
            color: #000;
            line-height: 1.4;
            opacity: 0.6;
            letter-spacing: -0.08px;
            margin-bottom: 20px;
        }

        /* 地图区域 */
        .location-map-area {
            width: 100%;
            height: 180px;
            background: #E8F1F7;
            border-radius: 12px;
            position: relative;
            overflow: hidden;
            margin-bottom: 16px;
        }

        .map-placeholder {
            width: 100%;
            height: 100%;
            position: relative;
            background: linear-gradient(135deg, #D9E9F3 0%, #C4DCE8 100%);
        }

        /* 地图网格效果 */
        .map-grid {
            width: 100%;
            height: 100%;
            background-image:
                linear-gradient(rgba(255, 255, 255, 0.2) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 255, 255, 0.2) 1px, transparent 1px);
            background-size: 30px 30px;
            animation: mapMove 20s linear infinite;
        }

        @keyframes mapMove {
            0% {
                background-position: 0 0;
            }
            100% {
                background-position: 30px 30px;
            }
        }

        /* 当前位置标记 */
        .current-location-marker {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
        }

        .marker-pulse {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 40px;
            height: 40px;
            background: rgba(0, 82, 204, 0.3);
            border-radius: 50%;
            animation: locationPulse 2s ease-out infinite;
        }

        @keyframes locationPulse {
            0% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
            }
            100% {
                transform: translate(-50%, -50%) scale(2);
                opacity: 0;
            }
        }

        .marker-dot {
            position: relative;
            width: 16px;
            height: 16px;
            background: #0052CC;
            border: 3px solid #fff;
            border-radius: 50%;
            box-shadow: 0 2px 8px rgba(0, 82, 204, 0.4);
        }

        /* 当前位置标签 */
        .current-location-badge {
            position: absolute;
            bottom: 12px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 6px 12px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 13px;
            font-weight: 500;
            color: #000;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .current-location-badge svg {
            flex-shrink: 0;
        }

        /* 选项按钮区域 */
        .location-alert-buttons {
            display: flex;
            flex-direction: column;
            border-top: 0.5px solid rgba(60, 60, 67, 0.18);
        }

        .location-option-button {
            width: 100%;
            height: 44px;
            background: transparent;
            border: none;
            border-bottom: 0.5px solid rgba(60, 60, 67, 0.18);
            font-size: 17px;
            color: #0052CC;
            cursor: pointer;
            transition: background 0.15s ease;
            font-weight: 400;
            letter-spacing: -0.4px;
        }

        .location-option-button:last-child {
            border-bottom: none;
        }

        .location-option-button:active {
            background: rgba(0, 0, 0, 0.04);
        }

        .location-option-button.primary {
            font-weight: 600;
        }

        /* 连接设备弹窗 - 优化版 */
        .connecting-alert {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            width: 300px;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(40px);
            -webkit-backdrop-filter: blur(40px);
            border-radius: 20px;
            overflow: hidden;
            opacity: 0;
            visibility: hidden;
            transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 202;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .connecting-alert.active {
            opacity: 1;
            visibility: visible;
            transform: translate(-50%, -50%) scale(1);
        }

        .connecting-content {
            padding: 32px 24px 24px;
            text-align: center;
        }

        /* 设备图标容器 */
        .connecting-device-icon {
            width: 72px;
            height: 72px;
            background: linear-gradient(135deg, #0052CC 0%, #003B99 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            box-shadow: 0 8px 24px rgba(0, 82, 204, 0.3);
            position: relative;
        }

        .connecting-device-icon svg {
            width: 36px;
            height: 36px;
            stroke: #fff;
            fill: none;
            stroke-width: 2.5;
            stroke-linecap: round;
            stroke-linejoin: round;
        }

        /* 脉冲动画环 */
        .connecting-device-icon::before {
            content: '';
            position: absolute;
            top: -4px;
            left: -4px;
            right: -4px;
            bottom: -4px;
            border: 2px solid rgba(0, 82, 204, 0.4);
            border-radius: 50%;
            animation: pulse-ring 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        @keyframes pulse-ring {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            100% {
                transform: scale(1.3);
                opacity: 0;
            }
        }

        .connecting-device-name {
            display: none; /* 隐藏设备名称 */
        }

        .connecting-device-id {
            font-size: 22px;
            color: #000;
            margin-bottom: 28px;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        /* 现代化加载动画 */
        .connecting-spinner {
            width: 48px;
            height: 48px;
            border: 4px solid rgba(0, 82, 204, 0.1);
            border-top-color: #0052CC;
            border-right-color: #0052CC;
            border-radius: 50%;
            animation: spin 1s cubic-bezier(0.5, 0, 0.5, 1) infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }

        .connecting-status {
            font-size: 15px;
            color: #000;
            opacity: 0.7;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        /* 连接进度点动画 */
        .connecting-status::after {
            content: '';
            display: inline-block;
            width: 4px;
            height: 4px;
            background: #0052CC;
            border-radius: 50%;
            animation: blink 1.4s infinite;
        }

        @keyframes blink {
            0%, 100% {
                opacity: 0;
            }
            50% {
                opacity: 1;
            }
        }

        /* 优化按钮样式 */
        .connecting-alert .alert-buttons {
            margin-top: 0;
            padding-top: 20px;
            border-top: 0.5px solid rgba(60, 60, 67, 0.12);
        }

        .connecting-alert .alert-button {
            height: 50px;
            font-size: 16px;
            font-weight: 600;
            color: #FF3B30;
            letter-spacing: -0.3px;
        }

        .connecting-alert .alert-button:active {
            background: rgba(255, 59, 48, 0.08);
        }

        /* 设备详情页面样式 */
        .device-detail-content {
            padding: 20px 0;
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .detail-status-card {
            background: #fff;
            border-radius: 20px;
            padding: 32px 24px;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .status-badge {
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
            background: #F2F2F7;
            color: #8E8E93;
        }

        .status-badge.connected {
            background: rgba(52, 199, 89, 0.1);
            color: #34C759;
        }

        .detail-device-icon {
            width: 80px;
            height: 80px;
            background: #F5F5F5;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .detail-device-icon svg {
            width: 40px;
            height: 40px;
            stroke: #000;
            fill: none;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
        }

        .detail-device-id {
            font-size: 18px;
            font-weight: 600;
            color: #000;
            text-align: center;
        }

        .detail-info-section {
            background: #fff;
            border-radius: 16px;
            padding: 4px 0;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            overflow: hidden;
        }

        .info-item {
            padding: 16px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 0.5px solid #E5E5EA;
        }

        .info-item:last-child {
            border-bottom: none;
        }

        .info-label {
            font-size: 16px;
            color: #000;
            font-weight: 500;
        }

        .info-value {
            font-size: 16px;
            color: #8E8E93;
        }

        .disconnect-btn {
            width: 100%;
            height: 52px;
            background: #fff;
            color: #FF3B30;
            border: none;
            border-radius: 14px;
            font-size: 17px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }

        .disconnect-btn:active {
            transform: scale(0.98);
            background: #F5F5F5;
        }
    </style>
</head>
<body>
    <div class="iphone-frame">
        <!-- 灵动岛 -->
        <div class="dynamic-island">
            <div class="island-camera"></div>
            <div class="island-sensor"></div>
        </div>

        <!-- 屏幕内容 -->
        <div class="screen">
            <!-- 状态栏 -->
            <div class="status-bar">
                <div class="time">9:41</div>
                <div class="status-icons">
                    <div class="signal">
                        <div class="signal-bar"></div>
                        <div class="signal-bar"></div>
                        <div class="signal-bar"></div>
                        <div class="signal-bar"></div>
                    </div>
                    <div class="wifi"></div>
                    <div class="battery"></div>
                </div>
            </div>

            <!-- 主内容区域 -->
            <div class="main-content">
                <!-- 设备页面 -->
                <div class="page-content active" id="devicePage">
                    <!-- 初始连接按钮视图 -->
                    <div class="initial-view" id="initialView">
                        <div class="device-header">设备</div>
                        <!-- 扩散圆环效果 -->
                        <div class="ripple-container">
                            <div class="ripple"></div>
                            <div class="ripple"></div>
                            <div class="ripple"></div>
                        </div>
                        <button class="connect-btn" id="connectBtn">
                            <svg viewBox="0 0 24 24">
                                <path d="M6.5 6.5l11 11M12 2l5 5-5 5v-10zM12 22l-5-5 5-5v10z"/>
                            </svg>
                            连接设备
                        </button>
                    </div>

                    <!-- 扫描蓝牙设备视图 -->
                    <div class="scanning-view" id="scanningView">
                        <div class="scanning-header">
                            <button class="back-btn" id="backBtn">
                                <svg viewBox="0 0 24 24">
                                    <path d="M15 18l-6-6 6-6"/>
                                </svg>
                            </button>
                            <div class="scanning-title">搜索设备</div>
                            <button class="back-btn" id="refreshBtn">
                                <svg viewBox="0 0 24 24">
                                    <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"/>
                                </svg>
                            </button>
                        </div>

                        <!-- 雷达扫描动画 -->
                        <div class="radar-container" id="radarContainer">
                            <div class="radar-wrapper">
                                <div class="radar-circle"></div>
                                <div class="radar-circle"></div>
                                <div class="radar-circle"></div>
                                <div class="radar-circle"></div>
                                <div class="bluetooth-icon-wrapper">
                                    <svg width="24" height="24" viewBox="0 0 24 24">
                                        <path d="M6.5 6.5l11 11L12 23V1l5.5 5.5-11 11"/>
                                    </svg>
                                </div>
                            </div>
                        </div>

                        <div class="radar-scanning-text" id="radarScanningText">搜索中...</div>

                        <div class="device-list hidden" id="bluetoothDeviceList">
                            <!-- 动态生成的设备列表 -->
                        </div>
                    </div>

                    <!-- 设备详情页面 -->
                    <div class="scanning-view" id="deviceDetailView">
                        <div class="scanning-header">
                            <button class="back-btn" id="backToScanBtn">
                                <svg viewBox="0 0 24 24">
                                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                                </svg>
                            </button>
                            <div class="scanning-title" id="detailDeviceName">充电桩 #001</div>
                            <div style="width: 36px;"></div>
                        </div>

                        <div class="device-detail-content">
                            <div class="detail-status-card">
                                <div class="status-badge connected">已连接</div>
                                <div class="detail-device-icon">
                                    <svg viewBox="0 0 24 24">
                                        <rect x="7" y="4" width="10" height="16" rx="2" />
                                        <line x1="9" y1="8" x2="15" y2="8" />
                                        <line x1="12" y1="11" x2="12" y2="17" />
                                        <line x1="9" y1="14" x2="15" y2="14" />
                                    </svg>
                                </div>
                                <div class="detail-device-id" id="detailDeviceId">设备ID: CHG-001</div>
                            </div>

                            <div class="detail-info-section">
                                <div class="info-item">
                                    <div class="info-label">设备状态</div>
                                    <div class="info-value">空闲中</div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">信号强度</div>
                                    <div class="info-value">强</div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">连接距离</div>
                                    <div class="info-value" id="detailDistance">1m</div>
                                </div>
                            </div>

                            <button class="disconnect-btn" id="disconnectBtn">
                                断开连接
                            </button>
                        </div>
                    </div>
                </div>

                <!-- 我的页面 -->
                <div class="page-content" id="minePage">
                    <div class="menu-list">
                        <div class="menu-item" id="languageSwitch">
                            <div class="menu-item-left">
                                <div class="menu-icon">
                                    <svg viewBox="0 0 24 24">
                                        <circle cx="12" cy="12" r="10" />
                                        <path d="M2 12h20M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z" />
                                    </svg>
                                </div>
                                <div class="menu-label">语言切换</div>
                            </div>
                            <div class="menu-value">中文</div>
                        </div>
                        <div class="menu-item" id="privacyItem">
                            <div class="menu-item-left">
                                <div class="menu-icon">
                                    <svg viewBox="0 0 24 24">
                                        <rect x="5" y="11" width="14" height="10" rx="2" />
                                        <path d="M12 17a2 2 0 1 0 0-4 2 2 0 0 0 0 4z" />
                                        <path d="M8 11V7a4 4 0 0 1 8 0v4" />
                                    </svg>
                                </div>
                                <div class="menu-label">隐私协议</div>
                            </div>
                            <div class="menu-arrow">›</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 底部菜单栏 -->
            <div class="bottom-nav">
                <div class="nav-item active" data-page="device">
                    <div class="nav-icon">
                        <svg viewBox="0 0 24 24">
                            <rect x="3" y="8" width="7" height="13" rx="2"/>
                            <rect x="14" y="8" width="7" height="13" rx="2"/>
                            <path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                        </svg>
                    </div>
                    <div class="nav-label">设备</div>
                </div>
                <div class="nav-item" data-page="mine">
                    <div class="nav-icon">
                        <svg viewBox="0 0 24 24">
                            <circle cx="12" cy="8" r="5"/>
                            <path d="M3 21v-2a4 4 0 0 1 4-4h10a4 4 0 0 1 4 4v2"/>
                        </svg>
                    </div>
                    <div class="nav-label">我的</div>
                </div>
            </div>

            <!-- 底部指示条 -->
            <div class="home-indicator"></div>

            <!-- 遮罩层 -->
            <div class="overlay" id="overlay"></div>

            <!-- 语言切换抽屉 -->
            <div class="drawer" id="languageDrawer">
                <div class="drawer-header">
                    <div class="drawer-title">选择语言</div>
                    <div class="drawer-close" id="drawerClose">×</div>
                </div>
                <div class="drawer-options">
                    <div class="drawer-option selected" data-lang="中文">简体中文</div>
                    <div class="drawer-option" data-lang="繁體中文">繁體中文</div>
                    <div class="drawer-option" data-lang="English">English</div>
                </div>
            </div>

            <!-- 蓝牙权限系统弹窗 -->
            <div class="system-alert" id="bluetoothAlert">
                <div class="alert-content">
                    <div class="alert-title">"移动充电"想要使用蓝牙</div>
                    <div class="alert-message">连接设备需要打开蓝牙。</div>
                </div>
                <div class="alert-buttons">
                    <button class="alert-button cancel" id="denyBluetooth">不允许</button>
                    <button class="alert-button primary" id="allowBluetooth">好</button>
                </div>
            </div>

            <!-- 定位权限系统弹窗 - iOS大卡片样式 -->
            <div class="location-permission-alert" id="locationAlert">
                <div class="location-alert-content">
                    <div class="location-alert-title">允许"移动充电"使用你的位置?</div>
                    <div class="location-alert-message">位置权限用于快速连接设备、识别定位。</div>

                    <!-- 地图区域 -->
                    <div class="location-map-area">
                        <div class="map-placeholder">
                            <!-- 模拟地图背景 -->
                            <div class="map-grid"></div>
                            <!-- 当前位置标记 -->
                            <div class="current-location-marker">
                                <div class="marker-pulse"></div>
                                <div class="marker-dot"></div>
                            </div>
                        </div>
                        <div class="current-location-badge">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none">
                                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z" stroke="#FF3B30" stroke-width="2" fill="#FF3B30" fill-opacity="0.1"/>
                                <circle cx="12" cy="10" r="3" stroke="#FF3B30" stroke-width="2" fill="#fff"/>
                            </svg>
                            <span>当前位置</span>
                        </div>
                    </div>
                </div>

                <!-- 三个选项按钮 -->
                <div class="location-alert-buttons">
                    <button class="location-option-button" id="allowLocationOnce">允许一次</button>
                    <button class="location-option-button primary" id="allowLocationWhileUsing">使用 App 时允许</button>
                    <button class="location-option-button" id="denyLocation">不允许</button>
                </div>
            </div>

            <!-- 连接设备弹窗 - 优化版 -->
            <div class="connecting-alert" id="connectingAlert">
                <div class="connecting-content">
                    <!-- 设备图标 -->
                    <div class="connecting-device-icon">
                        <svg viewBox="0 0 24 24">
                            <rect x="7" y="4" width="10" height="16" rx="2" />
                            <line x1="9" y1="8" x2="15" y2="8" />
                            <line x1="12" y1="11" x2="12" y2="17" />
                            <line x1="9" y1="14" x2="15" y2="14" />
                        </svg>
                    </div>
                    <!-- 设备名称 -->
                    <div class="connecting-device-name" id="connectingDeviceName">充电桩 #001</div>
                    <!-- 设备ID -->
                    <div class="connecting-device-id" id="connectingDeviceId">CHG-001</div>
                    <!-- 加载动画 -->
                    <div class="connecting-spinner"></div>
                    <!-- 连接状态 -->
                    <div class="connecting-status">正在建立连接</div>
                </div>
                <div class="alert-buttons">
                    <button class="alert-button cancel" id="cancelConnect">取消连接</button>
                </div>
            </div>

            <!-- 隐私协议抽屉 -->
            <div class="privacy-drawer" id="privacyDrawer">
                <div class="drawer-header">
                    <div class="drawer-title">隐私协议</div>
                    <div class="drawer-close" id="privacyClose">×</div>
                </div>
                <div class="privacy-content" id="privacyContent">
                    <h2>1. 信息收集</h2>
                    <p>我们会收集以下类型的信息：</p>
                    <ul>
                        <li>个人身份信息（如姓名、电话号码、电子邮件地址）</li>
                        <li>设备信息和充电记录</li>
                        <li>位置信息（用于查找附近的充电站）</li>
                        <li>支付信息（仅用于完成交易）</li>
                    </ul>

                    <h2>2. 信息使用</h2>
                    <p>我们使用收集的信息用于：</p>
                    <ul>
                        <li>提供充电服务</li>
                        <li>处理支付和账单</li>
                        <li>改进我们的服务质量</li>
                        <li>发送服务通知和更新</li>
                        <li>确保平台安全</li>
                    </ul>

                    <h2>3. 信息保护</h2>
                    <p>我们采用行业标准的安全措施来保护您的个人信息，包括：</p>
                    <ul>
                        <li>数据加密传输</li>
                        <li>安全的服务器存储</li>
                        <li>严格的访问控制</li>
                        <li>定期安全审计</li>
                    </ul>

                    <h2>4. 信息共享</h2>
                    <p>我们不会向第三方出售您的个人信息。仅在以下情况下会共享信息：</p>
                    <ul>
                        <li>获得您的明确同意</li>
                        <li>遵守法律法规要求</li>
                        <li>与服务提供商（如支付处理商）必要的共享</li>
                    </ul>

                    <h2>5. 您的权利</h2>
                    <p>您有权：</p>
                    <ul>
                        <li>访问和更新您的个人信息</li>
                        <li>删除您的账户和数据</li>
                        <li>选择退出某些数据收集</li>
                        <li>导出您的数据</li>
                    </ul>

                    <h2>6. Cookie 使用</h2>
                    <p>我们使用 Cookie 和类似技术来改善用户体验，记住您的偏好设置，分析网站使用情况。</p>

                    <h2>7. 儿童隐私</h2>
                    <p>我们的服务不面向 18 岁以下的儿童。我们不会故意收集儿童的个人信息。</p>

                    <h2>8. 隐私政策更新</h2>
                    <p>我们可能会不时更新本隐私政策。重大变更时，我们会通过应用通知或电子邮件通知您。</p>

                    <h2>9. 联系我们</h2>
                    <p>如果您对本隐私政策有任何疑问或建议，请通过以下方式联系我们：</p>
                    <ul>
                        <li>电子邮件：privacy@example.com</li>
                        <li>客服电话：400-XXX-XXXX</li>
                    </ul>

                    <p style="margin-top: 30px; color: #8E8E93; font-size: 12px;">最后更新日期：2025年10月29日</p>
                </div>
                <div class="privacy-footer">
                    <button class="agree-btn" id="agreeBtn">我已同意</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 多语言文本配置
        const i18n = {
            '中文': {
                // 设备页面
                deviceTitle: '设备',
                connectDevice: '连接设备',
                searchingDevices: '搜索设备',
                searching: '搜索中...',
                connectBtn: '连接',
                cancelConnect: '取消连接',
                connecting: '正在建立连接',
                device1: '充电桩 #001',
                device2: '充电桩 #002',
                device3: '充电桩 #003',
                statusIdle: '状态：空闲中',
                statusCharging: '状态：充电中',
                // 我的页面
                languageSwitch: '语言切换',
                privacyPolicy: '隐私协议',
                // 底部导航
                navDevice: '设备',
                navMine: '我的',
                // 抽屉
                drawerTitle: '选择语言',
                // 隐私协议
                privacyTitle: '隐私协议',
                agreeBtn: '我已同意',
                // 蓝牙权限
                bluetoothTitle: '"移动充电"想要使用蓝牙',
                bluetoothMessage: '连接设备需要打开蓝牙。',
                deny: '不允许',
                allow: '好',
                // 定位权限
                locationTitle: '允许"移动充电"使用你的位置?',
                locationMessage: '位置权限用于快速连接设备、识别定位。',
                locationBadge: '当前位置',
                allowOnce: '允许一次',
                allowWhileUsing: '使用 App 时允许',
                denyLocation: '不允许',
                privacyContent: `
                    <h2>1. 信息收集</h2>
                    <p>我们会收集以下类型的信息：</p>
                    <ul>
                        <li>个人身份信息（如姓名、电话号码、电子邮件地址）</li>
                        <li>设备信息和充电记录</li>
                        <li>位置信息（用于查找附近的充电站）</li>
                        <li>支付信息（仅用于完成交易）</li>
                    </ul>

                    <h2>2. 信息使用</h2>
                    <p>我们使用收集的信息用于：</p>
                    <ul>
                        <li>提供充电服务</li>
                        <li>处理支付和账单</li>
                        <li>改进我们的服务质量</li>
                        <li>发送服务通知和更新</li>
                        <li>确保平台安全</li>
                    </ul>

                    <h2>3. 信息保护</h2>
                    <p>我们采用行业标准的安全措施来保护您的个人信息，包括：</p>
                    <ul>
                        <li>数据加密传输</li>
                        <li>安全的服务器存储</li>
                        <li>严格的访问控制</li>
                        <li>定期安全审计</li>
                    </ul>

                    <h2>4. 信息共享</h2>
                    <p>我们不会向第三方出售您的个人信息。仅在以下情况下会共享信息：</p>
                    <ul>
                        <li>获得您的明确同意</li>
                        <li>遵守法律法规要求</li>
                        <li>与服务提供商（如支付处理商）必要的共享</li>
                    </ul>

                    <h2>5. 您的权利</h2>
                    <p>您有权：</p>
                    <ul>
                        <li>访问和更新您的个人信息</li>
                        <li>删除您的账户和数据</li>
                        <li>选择退出某些数据收集</li>
                        <li>导出您的数据</li>
                    </ul>

                    <h2>6. Cookie 使用</h2>
                    <p>我们使用 Cookie 和类似技术来改善用户体验，记住您的偏好设置，分析网站使用情况。</p>

                    <h2>7. 儿童隐私</h2>
                    <p>我们的服务不面向 18 岁以下的儿童。我们不会故意收集儿童的个人信息。</p>

                    <h2>8. 隐私政策更新</h2>
                    <p>我们可能会不时更新本隐私政策。重大变更时，我们会通过应用通知或电子邮件通知您。</p>

                    <h2>9. 联系我们</h2>
                    <p>如果您对本隐私政策有任何疑问或建议，请通过以下方式联系我们：</p>
                    <ul>
                        <li>电子邮件：privacy@example.com</li>
                        <li>客服电话：400-XXX-XXXX</li>
                    </ul>

                    <p style="margin-top: 30px; color: #8E8E93; font-size: 12px;">最后更新日期：2025年10月29日</p>
                `
            },
            '繁體中文': {
                deviceTitle: '設備',
                connectDevice: '連接設備',
                searchingDevices: '搜索設備',
                searching: '搜索中...',
                connectBtn: '連接',
                cancelConnect: '取消連接',
                connecting: '正在建立連接',
                device1: '充電樁 #001',
                device2: '充電樁 #002',
                device3: '充電樁 #003',
                statusIdle: '狀態：空閒中',
                statusCharging: '狀態：充電中',
                languageSwitch: '語言切換',
                privacyPolicy: '隱私協議',
                navDevice: '設備',
                navMine: '我的',
                drawerTitle: '選擇語言',
                privacyTitle: '隱私協議',
                agreeBtn: '我已同意',
                bluetoothTitle: '"移動充電"想要使用藍牙',
                bluetoothMessage: '連接設備需要打開藍牙。',
                deny: '不允許',
                allow: '好',
                // 定位權限
                locationTitle: '允許"移動充電"使用你的位置?',
                locationMessage: '位置權限用於快速連接設備、識別定位。',
                locationBadge: '當前位置',
                allowOnce: '允許一次',
                allowWhileUsing: '使用 App 時允許',
                denyLocation: '不允許',
                privacyContent: `
                    <h2>1. 信息收集</h2>
                    <p>我們會收集以下類型的信息：</p>
                    <ul>
                        <li>個人身份信息（如姓名、電話號碼、電子郵件地址）</li>
                        <li>設備信息和充電記錄</li>
                        <li>位置信息（用於查找附近的充電站）</li>
                        <li>支付信息（僅用於完成交易）</li>
                    </ul>

                    <h2>2. 信息使用</h2>
                    <p>我們使用收集的信息用於：</p>
                    <ul>
                        <li>提供充電服務</li>
                        <li>處理支付和賬單</li>
                        <li>改進我們的服務質量</li>
                        <li>發送服務通知和更新</li>
                        <li>確保平台安全</li>
                    </ul>

                    <h2>3. 信息保護</h2>
                    <p>我們採用行業標準的安全措施來保護您的個人信息，包括：</p>
                    <ul>
                        <li>數據加密傳輸</li>
                        <li>安全的服務器存儲</li>
                        <li>嚴格的訪問控制</li>
                        <li>定期安全審計</li>
                    </ul>

                    <h2>4. 信息共享</h2>
                    <p>我們不會向第三方出售您的個人信息。僅在以下情況下會共享信息：</p>
                    <ul>
                        <li>獲得您的明確同意</li>
                        <li>遵守法律法規要求</li>
                        <li>與服務提供商（如支付處理商）必要的共享</li>
                    </ul>

                    <h2>5. 您的權利</h2>
                    <p>您有權：</p>
                    <ul>
                        <li>訪問和更新您的個人信息</li>
                        <li>刪除您的賬戶和數據</li>
                        <li>選擇退出某些數據收集</li>
                        <li>導出您的數據</li>
                    </ul>

                    <h2>6. Cookie 使用</h2>
                    <p>我們使用 Cookie 和類似技術來改善用戶體驗，記住您的偏好設置，分析網站使用情況。</p>

                    <h2>7. 兒童隱私</h2>
                    <p>我們的服務不面向 18 歲以下的兒童。我們不會故意收集兒童的個人信息。</p>

                    <h2>8. 隱私政策更新</h2>
                    <p>我們可能會不時更新本隱私政策。重大變更時，我們會通過應用通知或電子郵件通知您。</p>

                    <h2>9. 聯繫我們</h2>
                    <p>如果您對本隱私政策有任何疑問或建議，請通過以下方式聯繫我們：</p>
                    <ul>
                        <li>電子郵件：privacy@example.com</li>
                        <li>客服電話：400-XXX-XXXX</li>
                    </ul>

                    <p style="margin-top: 30px; color: #8E8E93; font-size: 12px;">最後更新日期：2025年10月29日</p>
                `
            },
            'English': {
                deviceTitle: 'Devices',
                connectDevice: 'Connect Device',
                searchingDevices: 'Search Devices',
                searching: 'Searching...',
                connectBtn: 'Connect',
                cancelConnect: 'Cancel',
                connecting: 'Connecting',
                device1: 'Charger #001',
                device2: 'Charger #002',
                device3: 'Charger #003',
                statusIdle: 'Status: Available',
                statusCharging: 'Status: Charging',
                languageSwitch: 'Language',
                privacyPolicy: 'Privacy Policy',
                navDevice: 'Devices',
                navMine: 'Me',
                drawerTitle: 'Select Language',
                privacyTitle: 'Privacy Policy',
                agreeBtn: 'I Agree',
                bluetoothTitle: '"Mobile Charging" Would Like to Use Bluetooth',
                bluetoothMessage: 'Bluetooth is required to connect to devices.',
                deny: 'Don\'t Allow',
                allow: 'OK',
                // Location permission
                locationTitle: 'Allow "Mobile Charging" to access your location?',
                locationMessage: 'Location is used to quickly connect devices and identify location.',
                locationBadge: 'Current Location',
                allowOnce: 'Allow Once',
                allowWhileUsing: 'While Using the App',
                denyLocation: 'Don\'t Allow',
                privacyContent: `
                    <h2>1. Information Collection</h2>
                    <p>We collect the following types of information:</p>
                    <ul>
                        <li>Personal identification information (such as name, phone number, email address)</li>
                        <li>Device information and charging records</li>
                        <li>Location information (to find nearby charging stations)</li>
                        <li>Payment information (only for completing transactions)</li>
                    </ul>

                    <h2>2. Information Usage</h2>
                    <p>We use the collected information for:</p>
                    <ul>
                        <li>Providing charging services</li>
                        <li>Processing payments and billing</li>
                        <li>Improving our service quality</li>
                        <li>Sending service notifications and updates</li>
                        <li>Ensuring platform security</li>
                    </ul>

                    <h2>3. Information Protection</h2>
                    <p>We adopt industry-standard security measures to protect your personal information, including:</p>
                    <ul>
                        <li>Encrypted data transmission</li>
                        <li>Secure server storage</li>
                        <li>Strict access control</li>
                        <li>Regular security audits</li>
                    </ul>

                    <h2>4. Information Sharing</h2>
                    <p>We do not sell your personal information to third parties. We only share information in the following cases:</p>
                    <ul>
                        <li>With your explicit consent</li>
                        <li>To comply with legal and regulatory requirements</li>
                        <li>Necessary sharing with service providers (such as payment processors)</li>
                    </ul>

                    <h2>5. Your Rights</h2>
                    <p>You have the right to:</p>
                    <ul>
                        <li>Access and update your personal information</li>
                        <li>Delete your account and data</li>
                        <li>Opt out of certain data collection</li>
                        <li>Export your data</li>
                    </ul>

                    <h2>6. Cookie Usage</h2>
                    <p>We use cookies and similar technologies to improve user experience, remember your preferences, and analyze website usage.</p>

                    <h2>7. Children's Privacy</h2>
                    <p>Our services are not intended for children under 18. We do not knowingly collect personal information from children.</p>

                    <h2>8. Privacy Policy Updates</h2>
                    <p>We may update this privacy policy from time to time. For significant changes, we will notify you via app notifications or email.</p>

                    <h2>9. Contact Us</h2>
                    <p>If you have any questions or suggestions about this privacy policy, please contact us via:</p>
                    <ul>
                        <li>Email: privacy@example.com</li>
                        <li>Customer Service: 400-XXX-XXXX</li>
                    </ul>

                    <p style="margin-top: 30px; color: #8E8E93; font-size: 12px;">Last Updated: October 29, 2025</p>
                `
            }
        };

        // 更新界面语言
        function updateLanguage(lang) {
            const texts = i18n[lang];
            if (!texts) return;

            // 设备页面
            document.querySelector('#devicePage .device-header').textContent = texts.deviceTitle;
            const connectBtn = document.getElementById('connectBtn');
            if (connectBtn) {
                const btnText = connectBtn.querySelector('svg').nextSibling;
                if (btnText && btnText.nodeType === Node.TEXT_NODE) {
                    btnText.textContent = texts.connectDevice;
                }
            }

            // 搜索设备标题
            const scanningTitle = document.querySelector('.scanning-title');
            if (scanningTitle) {
                scanningTitle.textContent = texts.searchingDevices;
            }

            // 搜索中文字
            const radarScanningText = document.getElementById('radarScanningText');
            if (radarScanningText) {
                radarScanningText.textContent = texts.searching;
            }

            // 蓝牙权限弹窗
            const bluetoothTitle = document.querySelector('#bluetoothAlert .alert-title');
            const bluetoothMessage = document.querySelector('#bluetoothAlert .alert-message');
            const denyBtn = document.getElementById('denyBluetooth');
            const allowBtn = document.getElementById('allowBluetooth');
            if (bluetoothTitle) bluetoothTitle.textContent = texts.bluetoothTitle;
            if (bluetoothMessage) bluetoothMessage.textContent = texts.bluetoothMessage;
            if (denyBtn) denyBtn.textContent = texts.deny;
            if (allowBtn) allowBtn.textContent = texts.allow;

            // 定位权限弹窗
            const locationTitle = document.querySelector('#locationAlert .location-alert-title');
            const locationMessage = document.querySelector('#locationAlert .location-alert-message');
            const locationBadge = document.querySelector('#locationAlert .current-location-badge span');
            const allowOnceBtn = document.getElementById('allowLocationOnce');
            const allowWhileUsingBtn = document.getElementById('allowLocationWhileUsing');
            const denyLocationBtn = document.getElementById('denyLocation');
            if (locationTitle) locationTitle.textContent = texts.locationTitle;
            if (locationMessage) locationMessage.textContent = texts.locationMessage;
            if (locationBadge) locationBadge.textContent = texts.locationBadge;
            if (allowOnceBtn) allowOnceBtn.textContent = texts.allowOnce;
            if (allowWhileUsingBtn) allowWhileUsingBtn.textContent = texts.allowWhileUsing;
            if (denyLocationBtn) denyLocationBtn.textContent = texts.denyLocation;

            // 连接弹窗
            const connectingStatus = document.querySelector('#connectingAlert .connecting-status');
            const cancelConnectBtn = document.getElementById('cancelConnect');
            if (connectingStatus) connectingStatus.textContent = texts.connecting;
            if (cancelConnectBtn) cancelConnectBtn.textContent = texts.cancelConnect;

            // 更新设备列表中的连接按钮
            const connectDeviceBtns = document.querySelectorAll('.connect-device-btn');
            connectDeviceBtns.forEach(btn => {
                btn.textContent = texts.connectBtn;
            });

            // 我的页面
            const menuLabels = document.querySelectorAll('#minePage .menu-label');
            if (menuLabels.length >= 2) {
                menuLabels[0].textContent = texts.languageSwitch;
                menuLabels[1].textContent = texts.privacyPolicy;
            }

            // 底部导航
            const navLabels = document.querySelectorAll('.nav-label');
            if (navLabels.length >= 2) {
                navLabels[0].textContent = texts.navDevice;
                navLabels[1].textContent = texts.navMine;
            }

            // 抽屉标题
            const languageDrawerTitle = document.querySelector('#languageDrawer .drawer-title');
            const privacyDrawerTitle = document.querySelector('#privacyDrawer .drawer-title');
            if (languageDrawerTitle) languageDrawerTitle.textContent = texts.drawerTitle;
            if (privacyDrawerTitle) privacyDrawerTitle.textContent = texts.privacyTitle;

            // 隐私协议内容
            const privacyContent = document.querySelector('#privacyContent');
            if (privacyContent) {
                privacyContent.innerHTML = texts.privacyContent;
            }

            // 同意按钮文字
            const agreeBtn = document.getElementById('agreeBtn');
            if (agreeBtn) {
                agreeBtn.textContent = texts.agreeBtn;
            }
        }

        // 获取所有菜单项和页面
        const navItems = document.querySelectorAll('.nav-item');
        const pages = document.querySelectorAll('.page-content');

        // 菜单切换功能
        navItems.forEach(item => {
            item.addEventListener('click', function() {
                const pageName = this.getAttribute('data-page');

                if (pageName === 'device') {
                    // 设备页面：保持在当前页面
                    navItems.forEach(nav => nav.classList.remove('active'));
                    pages.forEach(page => page.classList.remove('active'));
                    this.classList.add('active');
                    document.getElementById('devicePage').classList.add('active');
                } else if (pageName === 'mine') {
                    // 我的页面：跳转到 profile-2menu.html
                    window.location.href = 'profile-2menu.html';
                }
            });
        });

        // 语言切换抽屉功能
        const languageSwitch = document.getElementById('languageSwitch');
        const languageDrawer = document.getElementById('languageDrawer');
        const overlay = document.getElementById('overlay');
        const drawerClose = document.getElementById('drawerClose');
        const drawerOptions = document.querySelectorAll('.drawer-option');

        // 打开抽屉
        languageSwitch.addEventListener('click', function() {
            languageDrawer.classList.add('active');
            overlay.classList.add('active');
        });

        // 关闭抽屉
        function closeDrawer() {
            languageDrawer.classList.remove('active');
            overlay.classList.remove('active');
        }

        drawerClose.addEventListener('click', closeDrawer);

        // 选择语言
        drawerOptions.forEach(option => {
            option.addEventListener('click', function() {
                // 移除所有选中状态
                drawerOptions.forEach(opt => opt.classList.remove('selected'));

                // 添加当前选中状态
                this.classList.add('selected');

                // 更新显示的语言
                const selectedLang = this.getAttribute('data-lang');
                languageSwitch.querySelector('.menu-value').textContent = selectedLang;

                // 更新整个系统的语言
                updateLanguage(selectedLang);

                // 保存语言偏好到本地存储
                localStorage.setItem('preferredLanguage', selectedLang);

                // 关闭抽屉
                closeDrawer();
            });
        });

        // 页面加载时恢复语言设置
        const savedLanguage = localStorage.getItem('preferredLanguage') || 'English';
        // 始终调用 updateLanguage 以确保所有元素都正确翻译
        updateLanguage(savedLanguage);
        languageSwitch.querySelector('.menu-value').textContent = savedLanguage;
        // 更新抽屉中的选中状态
        drawerOptions.forEach(opt => {
            if (opt.getAttribute('data-lang') === savedLanguage) {
                opt.classList.add('selected');
            } else {
                opt.classList.remove('selected');
            }
        });

        // 监听其他页面的语言变化
        window.addEventListener('storage', function(e) {
            if (e.key === 'preferredLanguage' && e.newValue) {
                updateLanguage(e.newValue);
                languageSwitch.querySelector('.menu-value').textContent = e.newValue;
                // 更新抽屉中的选中状态
                drawerOptions.forEach(opt => {
                    if (opt.getAttribute('data-lang') === e.newValue) {
                        opt.classList.add('selected');
                    } else {
                        opt.classList.remove('selected');
                    }
                });
            }
        });

        // 隐私协议抽屉功能
        const privacyItem = document.getElementById('privacyItem');
        const privacyDrawer = document.getElementById('privacyDrawer');
        const privacyClose = document.getElementById('privacyClose');

        // 打开隐私协议抽屉
        privacyItem.addEventListener('click', function() {
            privacyDrawer.classList.add('active');
            overlay.classList.add('active');
        });

        // 关闭隐私协议抽屉
        function closePrivacyDrawer() {
            privacyDrawer.classList.remove('active');
            overlay.classList.remove('active');
        }

        privacyClose.addEventListener('click', closePrivacyDrawer);

        // 点击遮罩关闭所有抽屉（隐私协议初次显示时不允许点击遮罩关闭）
        // 注意：连接弹窗显示时不应关闭
        overlay.addEventListener('click', function() {
            // 如果连接弹窗正在显示，不执行任何操作
            if (connectingAlert.classList.contains('active')) {
                return;
            }

            const hasAgreed = localStorage.getItem('privacyAgreed');
            if (hasAgreed === 'true') {
                closeDrawer();
                closePrivacyDrawer();
            }
        });

        // 同意按钮功能
        const agreeBtn = document.getElementById('agreeBtn');
        agreeBtn.addEventListener('click', function() {
            localStorage.setItem('privacyAgreed', 'true');
            closePrivacyDrawer();
        });

        // 蓝牙权限弹窗功能
        const connectBtn = document.getElementById('connectBtn');
        const bluetoothAlert = document.getElementById('bluetoothAlert');
        const allowBluetooth = document.getElementById('allowBluetooth');
        const denyBluetooth = document.getElementById('denyBluetooth');
        const initialView = document.getElementById('initialView');
        const scanningView = document.getElementById('scanningView');
        const bluetoothDeviceList = document.getElementById('bluetoothDeviceList');

        // 模拟蓝牙设备数据
        const mockDevices = [
            { name: '充电桩 #001', id: 'CHG-001', signal: 4, distance: '1m' },
            { name: '充电桩 #002', id: 'CHG-002', signal: 3, distance: '3m' },
            { name: '充电桩 #003', id: 'CHG-003', signal: 4, distance: '2m' },
            { name: '充电桩 #004', id: 'CHG-004', signal: 2, distance: '5m' },
            { name: '充电桩 #005', id: 'CHG-005', signal: 3, distance: '4m' }
        ];

        // 连接弹窗元素
        const connectingAlert = document.getElementById('connectingAlert');
        const connectingDeviceName = document.getElementById('connectingDeviceName');
        const connectingDeviceId = document.getElementById('connectingDeviceId');
        const cancelConnect = document.getElementById('cancelConnect');
        const deviceDetailView = document.getElementById('deviceDetailView');
        const detailDeviceName = document.getElementById('detailDeviceName');
        const detailDeviceId = document.getElementById('detailDeviceId');
        const detailDistance = document.getElementById('detailDistance');

        // 连接超时定时器
        let connectionTimeout = null;

        // 生成设备列表 - 简洁风格
        function generateDeviceList() {
            bluetoothDeviceList.innerHTML = '';
            bluetoothDeviceList.classList.remove('hidden');

            // 获取当前语言
            const savedLanguage = localStorage.getItem('preferredLanguage') || 'English';
            const texts = i18n[savedLanguage];

            // 创建设备组容器
            const deviceGroup = document.createElement('div');
            deviceGroup.className = 'device-group';

            mockDevices.forEach(device => {
                const deviceCard = document.createElement('div');
                deviceCard.className = 'device-card';
                deviceCard.innerHTML = `
                    <div class="device-info">
                        <div class="device-name">${device.id}</div>
                    </div>
                    <button class="connect-device-btn">${texts.connectBtn}</button>
                `;

                // 给连接按钮添加点击事件
                const connectBtn = deviceCard.querySelector('.connect-device-btn');
                connectBtn.addEventListener('click', function(e) {
                    e.stopPropagation(); // 防止触发卡片点击

                    // 显示连接弹窗，设置设备信息
                    connectingDeviceName.textContent = device.name;
                    connectingDeviceId.textContent = device.id;
                    connectingAlert.classList.add('active');
                    overlay.classList.add('active');
                    console.log(`开始连接到 ${device.name} (${device.id})...`);

                    // 模拟连接过程(2.5秒后连接成功)
                    connectionTimeout = setTimeout(() => {
                        console.log(`成功连接到 ${device.name}`);
                        console.log('准备跳转到 search.html...');

                        // 连接成功后立即跳转到搜索页面
                        try {
                            console.log('执行跳转...');
                            window.location.href = 'search.html';
                            console.log('跳转命令已执行');
                        } catch (error) {
                            console.error('跳转失败:', error);
                            // 如果跳转失败，手动隐藏弹窗
                            connectingAlert.classList.remove('active');
                            overlay.classList.remove('active');
                        }
                    }, 2500);
                });

                deviceGroup.appendChild(deviceCard);
            });

            bluetoothDeviceList.appendChild(deviceGroup);
        }

        // 取消连接按钮
        cancelConnect.addEventListener('click', function() {
            // 清除连接超时定时器
            if (connectionTimeout) {
                clearTimeout(connectionTimeout);
                connectionTimeout = null;
            }

            connectingAlert.classList.remove('active');
            overlay.classList.remove('active');
            console.log('用户取消了连接');
        });

        // 点击连接设备按钮 - 先显示定位权限弹窗
        connectBtn.addEventListener('click', function() {
            locationAlert.classList.add('active');
            overlay.classList.add('active');
        });

        // 获取雷达相关元素
        const radarContainer = document.getElementById('radarContainer');
        const radarScanningText = document.getElementById('radarScanningText');

        // 获取底部菜单栏
        const bottomNav = document.querySelector('.bottom-nav');

        // 允许蓝牙 - 开始雷达扫描
        allowBluetooth.addEventListener('click', function() {
            bluetoothAlert.classList.remove('active');
            overlay.classList.remove('active');

            // 切换到扫描视图
            initialView.style.display = 'none';
            scanningView.classList.add('active');

            // 隐藏底部菜单栏
            bottomNav.style.display = 'none';

            // 雷达动画始终显示，初始隐藏设备列表
            radarScanningText.style.display = 'block';
            bluetoothDeviceList.classList.add('hidden');

            // 2秒后显示设备列表（雷达继续动画）
            setTimeout(() => {
                generateDeviceList();
            }, 2000);

            console.log('用户允许了蓝牙访问，开始雷达扫描设备');
        });

        // 不允许蓝牙
        denyBluetooth.addEventListener('click', function() {
            bluetoothAlert.classList.remove('active');
            overlay.classList.remove('active');
            console.log('用户拒绝了蓝牙访问');
        });

        // 定位权限弹窗功能
        const locationAlert = document.getElementById('locationAlert');
        const allowLocationOnce = document.getElementById('allowLocationOnce');
        const allowLocationWhileUsing = document.getElementById('allowLocationWhileUsing');
        const denyLocation = document.getElementById('denyLocation');

        console.log('定位权限元素:', {locationAlert, allowLocationOnce, allowLocationWhileUsing, denyLocation});

        // 允许定位一次 - 显示蓝牙权限弹窗
        if (allowLocationOnce) {
            allowLocationOnce.addEventListener('click', function() {
                console.log('点击了允许一次按钮');
            locationAlert.classList.remove('active');
            // 不立即移除遮罩，等待蓝牙权限弹窗

            // 显示蓝牙权限弹窗
            setTimeout(() => {
                bluetoothAlert.classList.add('active');
            }, 200);

            console.log('用户允许了定位访问（一次）');
            });
        }

        // 使用App时允许定位 - 显示蓝牙权限弹窗
        if (allowLocationWhileUsing) {
            allowLocationWhileUsing.addEventListener('click', function() {
                console.log('点击了使用App时允许按钮');
            locationAlert.classList.remove('active');
            // 不立即移除遮罩，等待蓝牙权限弹窗

            // 显示蓝牙权限弹窗
            setTimeout(() => {
                bluetoothAlert.classList.add('active');
            }, 200);

            console.log('用户允许了定位访问（使用App时）');
            });
        }

        // 不允许定位
        if (denyLocation) {
            denyLocation.addEventListener('click', function() {
                console.log('点击了不允许按钮');
            locationAlert.classList.remove('active');
            overlay.classList.remove('active');
            console.log('用户拒绝了定位访问');
            });
        }

        // 扫描相关元素
        const backBtn = document.getElementById('backBtn');
        const refreshBtn = document.getElementById('refreshBtn');

        // 返回按钮
        backBtn.addEventListener('click', function() {
            scanningView.classList.remove('active');
            initialView.style.display = 'block';

            // 显示底部菜单栏
            bottomNav.style.display = 'flex';

            // 重置所有状态
            radarScanningText.style.display = 'none';
            bluetoothDeviceList.classList.add('hidden');
            bluetoothDeviceList.innerHTML = '';
        });

        // 刷新按钮
        refreshBtn.addEventListener('click', function() {
            // 添加旋转动画
            refreshBtn.classList.add('refreshing');

            // 雷达继续显示，隐藏设备列表
            radarScanningText.style.display = 'block';
            bluetoothDeviceList.classList.add('hidden');
            bluetoothDeviceList.innerHTML = '';

            // 模拟扫描延迟
            setTimeout(() => {
                // 显示设备列表（雷达继续动画）
                generateDeviceList();
                refreshBtn.classList.remove('refreshing');
            }, 2000);

            console.log('重新扫描蓝牙设备...');
        });

        // 设备详情页面按钮功能
        const backToScanBtn = document.getElementById('backToScanBtn');
        const disconnectBtn = document.getElementById('disconnectBtn');

        // 返回扫描页面
        backToScanBtn.addEventListener('click', function() {
            deviceDetailView.classList.remove('active');
            scanningView.classList.add('active');
            console.log('返回到扫描页面');
        });

        // 断开连接
        disconnectBtn.addEventListener('click', function() {
            // 隐藏设备详情页面
            deviceDetailView.classList.remove('active');

            // 隐藏扫描视图
            scanningView.classList.remove('active');

            // 显示初始视图
            initialView.style.display = 'block';

            // 显示底部菜单栏
            bottomNav.style.display = 'flex';

            // 清空设备列表
            bluetoothDeviceList.innerHTML = '';

            console.log('已断开设备连接');
        });

        // 页面加载时自动显示隐私协议
        window.addEventListener('DOMContentLoaded', function() {
            // 每次进入都显示隐私协议
            setTimeout(() => {
                privacyDrawer.classList.add('active');
                overlay.classList.add('active');
            }, 500);
        });
    </script>
</body>
</html>
